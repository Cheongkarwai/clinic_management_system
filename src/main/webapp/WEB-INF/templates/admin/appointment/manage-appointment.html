<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org">
<head>
<link rel="stylesheet" th:href="@{/static/css/admin-shared.css}" />
<link
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css"
	rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css"
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" />
</head>
<body>
	<div class="container-fluid h-100">
		<div class="row h-100">
			<aside class="col-md-2 h-100"
				th:insert="fragments/sideMenu.html :: sideMenu"></aside>
			<main class="col-md-10 px-5">
				<h1 class="py-5">Appointment</h1>
				<div class="top">
					<a class="border rounded p-2" id="create-appointment-btn"
						th:href="@{/appointments/add-appointment/index}"> <i
						class="fa-solid fa-plus"></i> Create New Appointment
					</a>
				</div>
				<br />
				<table class="table border" id="appointment-table">
					<tr>
						<th class="text-center">No</th>
						<th>Appointment Start Date Time</th>
						<th>Appointment End Date Time</th>
						<th>Doctor</th>
						<th>Patient Details</th>
						<th colspan="2">Action</th>
					</tr>
					<tr th:each="appointment,itr : ${appointmentList}">
						<td class="text-center" th:text="${itr.count}"></td>
						<td th:text="${appointment.appointmentStartDateTime}"></td>
						<td th:text="${appointment.appointmentEndDateTime}"></td>
						<td
							th:text="|${appointment.doctor.name}-${appointment.doctor.specialization}|"></td>
						<td>
							<form method="GET"
								th:action="@{/appointments/{appointmentId}/patients/{patientId}/details(appointmentId=${appointment.id},
					patientId=${appointment.patient.id})}">
								<button class="btn" type="submit">View</button>
							</form>
						</td>
						<td>
							<form th:method="PUT"
								th:action="@{/appointments/{appointmentId}/status/true(appointmentId=${appointment.id})}">
								<button class="btn" type="submit">Mark as done</button>
							</form>
						</td>
						<td>
							<form th:method="DELETE"
								th:action="@{/appointments/{appointmentId}(appointmentId=${appointment.id})}">
								<button class="btn" type="submit">Delete</button>
							</form>
						</td>
					</tr>
				</table>
			</main>
		</div>
	</div>
	<script>
		function deleteAppointment(e, form) {
			e.preventDefault();

			let confirmDelete = confirm("Are you sure to delete this appointment");

			if (confirmDelete) {
				form.submit();
			}
		}
	</script>
</body>
</html>